# ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚¬ã‚¤ãƒ‰

CL-Regexãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¸ã®è²¢çŒ®ã‚’æ­“è¿ã—ã¾ã™ï¼ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€åŠ¹æœçš„ã§é«˜å“è³ªãªè²¢çŒ®ã‚’è¡Œã†ãŸã‚ã®æŒ‡é‡ã‚’æä¾›ã—ã¾ã™ã€‚

## ç›®æ¬¡

- [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç›®æ¨™](#ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç›®æ¨™)
- [é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](#é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—)
- [ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®ç¨®é¡](#ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®ç¨®é¡)
- [é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹](#é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹)
- [ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„](#ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„)
- [ãƒ†ã‚¹ãƒˆè¦ä»¶](#ãƒ†ã‚¹ãƒˆè¦ä»¶)
- [ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¦ä»¶](#ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¦ä»¶)
- [ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ä»¶](#ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ä»¶)
- [ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹](#ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹)

---

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç›®æ¨™

CL-Regexã¯ä»¥ä¸‹ã®ç›®æ¨™ã‚’è¿½æ±‚ã—ã¦ã„ã¾ã™ï¼š

### 1. é«˜å“è³ªã®æ€§èƒ½
- **ã‚¼ãƒ­ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰**: ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚æœ€é©åŒ–ã«ã‚ˆã‚‹å®Ÿè¡Œæ™‚ã‚³ã‚¹ãƒˆã®æœ€å°åŒ–
- **ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ é©æ–°**: æ—¢å­˜æ‰‹æ³•ã‚’ä¸Šå›ã‚‹ã™ã‚‹æ–°ã—ã„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®é–‹ç™º
- **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**: å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã¨ä¸¦åˆ—å‡¦ç†ã¸ã®å¯¾å¿œ

### 2. åŠ¹ç‡çš„ãªè¡¨ç¾åŠ›
- **Så¼ãƒ‘ã‚¿ãƒ¼ãƒ³**: å¾“æ¥ã®æ–‡å­—åˆ—æ­£è¦è¡¨ç¾ã‚’ä¸Šå›ã‚‹ã—ãŸè¡¨ç¾åŠ›
- **Prologçµ±åˆ**: è«–ç†ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¨ã®èåˆ
- **å†å¸°çš„ãƒ‘ã‚¿ãƒ¼ãƒ³**: æ–‡è„ˆè‡ªç”±è¨€èªãƒ»æ–‡è„ˆä¾å­˜è¨€èªã¸ã®å¯¾å¿œ

### 3. å„ªã‚ŒãŸé–‹ç™ºä½“é¨“
- **ãƒã‚¯ãƒ­DSL**: æ¥µã‚ã¦èª­ã¿ã‚„ã™ãä¿å®ˆã—ã‚„ã™ã„ã‚³ãƒ¼ãƒ‰
- **å‹å®‰å…¨æ€§**: Common Lispã®å‹ã‚·ã‚¹ãƒ†ãƒ ã‚’æ´»ç”¨ã—ãŸå®‰å…¨æ€§
- **ãƒ‡ãƒãƒƒã‚°æ”¯æ´**: åŒ…æ‹¬çš„ãªãƒ‡ãƒãƒƒã‚°ãƒ»ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°æ©Ÿèƒ½

---

## é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å¿…è¦ãªç’°å¢ƒ

```bash
# Common Lispå®Ÿè£…ï¼ˆæ¨å¥¨: SBCL 2.0+ï¼‰
# Ubuntu/Debian
sudo apt-get install sbcl

# macOS
brew install sbcl

# Quicklispï¼ˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ï¼‰
curl -O https://beta.quicklisp.org/quicklisp.lisp
sbcl --load quicklisp.lisp --eval "(quicklisp-quickstart:install)"
```

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¯ãƒ­ãƒ¼ãƒ³ã¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/takeokunn/cl-regex.git
cd cl-regex

# é–‹ç™ºç”¨ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sbcl --eval "(ql:quickload :cl-regex-test)" --quit

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã§ç’°å¢ƒç¢ºèª
sbcl --eval "(ql:quickload :cl-regex-test)" \
     --eval "(cl-regex-test:run-all-tests)" \
     --quit
```

### æ¨å¥¨é–‹ç™ºãƒ„ãƒ¼ãƒ«

```lisp
;; SLIMEï¼ˆEmacsç”¨ï¼‰ã¾ãŸã¯ SLY
;; Vimç”¨: Slimv
;; VS Codeç”¨: ALIVE

;; ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®šãƒ„ãƒ¼ãƒ«
(ql:quickload :trivial-benchmark)

;; ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ãƒ„ãƒ¼ãƒ«
(ql:quickload :sb-profile)  ; SBCLå°‚ç”¨
```

---

## ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®ç¨®é¡

### ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„
æœ€ã‚‚ä¾¡å€¤ã®é«˜ã„ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

**æ±‚ã‚ã‚‰ã‚Œã‚‹æ”¹å–„**:
- æ–°ã—ã„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å®Ÿè£…
- æ—¢å­˜ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æœ€é©åŒ–
- ä¸¦åˆ—åŒ–ãƒ»SIMDæ´»ç”¨
- ãƒ¡ãƒ¢ãƒªåŠ¹ç‡æ”¹å–„

**æå‡ºè¦ä»¶**:
- ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯çµæœã®æ·»ä»˜
- ç†è«–çš„æ ¹æ‹ ã®èª¬æ˜
- æ—¢å­˜ãƒ†ã‚¹ãƒˆã®é€šé

### ğŸ¯ æ–°æ©Ÿèƒ½é–‹ç™º
CL-Regexã®è¡¨ç¾åŠ›ã‚’æ‹¡å¼µã™ã‚‹æ©Ÿèƒ½ã§ã™ã€‚

**ä¾‹**:
- æ–°ã—ã„Så¼ãƒ‘ã‚¿ãƒ¼ãƒ³è¦ç´ 
- Prologè¦å‰‡ã®æ‹¡å¼µ
- ã‚«ã‚¹ã‚¿ãƒ ã‚ªãƒšãƒ¬ãƒ¼ã‚¿
- ãƒ‡ãƒãƒƒã‚°ãƒ»ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°æ©Ÿèƒ½

### ğŸ› ãƒã‚°ä¿®æ­£
å“è³ªå‘ä¸Šã«ç›´çµã™ã‚‹é‡è¦ãªã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

**ãƒ—ãƒ­ã‚»ã‚¹**:
1. Issueä½œæˆï¼ˆå†ç¾æ‰‹é †ã‚’å«ã‚€ï¼‰
2. æ ¹æœ¬åŸå› ã®ç‰¹å®š
3. ä¿®æ­£ã¨ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ 
4. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å½±éŸ¿ã®ç¢ºèª

### ğŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ”¹å–„
DiÃ¡taxisãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã«åŸºã¥ãé«˜å“è³ªãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€‚

**æ”¹å–„å¯¾è±¡**:
- ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã®æ‹¡å……
- How-toã‚¬ã‚¤ãƒ‰ã®è¿½åŠ 
- APIä»•æ§˜ã®è©³ç´°åŒ–
- å®Ÿä¾‹ã¨ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹

### ğŸ§ª ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ 
Property-Based Testingã¨TDDã®å®Ÿè·µã€‚

**é‡ç‚¹é ˜åŸŸ**:
- ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã®ã‚«ãƒãƒ¬ãƒƒã‚¸
- æ€§èƒ½ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ
- äº’æ›æ€§ãƒ†ã‚¹ãƒˆ
- ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆ

---

## é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹

### 1. Issueé§†å‹•é–‹ç™º

```mermaid
flowchart LR
    A[Issueä½œæˆ] --> B[è­°è«–ãƒ»è¨­è¨ˆ]
    B --> C[å®Ÿè£…é–‹å§‹]
    C --> D[Draft PRä½œæˆ]
    D --> E[ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»æ”¹å–„]
    E --> F[æœ€çµ‚ãƒ¬ãƒ“ãƒ¥ãƒ¼]
    F --> G[ãƒãƒ¼ã‚¸]

    classDef planning fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef implementation fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef review fill:#fff3e0,stroke:#e65100,stroke-width:2px

    class A,B planning
    class C,D implementation
    class E,F,G review
```

### 2. ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥

```bash
# æ©Ÿèƒ½ãƒ–ãƒ©ãƒ³ãƒã®ä½œæˆ
git checkout -b feature/good-optimization

# ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„ã®å ´åˆ
git checkout -b perf/simd-acceleration

# ãƒã‚°ä¿®æ­£ã®å ´åˆ
git checkout -b fix/memory-leak-in-nfa
```

### 3. ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¦ç´„

```bash
# å½¢å¼: <type>(<scope>): <description>

# ä¾‹:
feat(engine): implement SIMD-accelerated character class matching
perf(dfa): optimize state transition table lookup
fix(parser): handle escaped characters in S-expr patterns
docs(tutorial): add advanced pattern examples
test(nfa): add property-based tests for backtracking
```

---

## ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

### 1. Lisp ã‚¹ã‚¿ã‚¤ãƒ«ã‚¬ã‚¤ãƒ‰

```lisp
;; âœ… æ¨å¥¨ã‚¹ã‚¿ã‚¤ãƒ«

;; é–¢æ•°å: ã‚±ãƒãƒ–ã‚±ãƒ¼ã‚¹
(defun compile-pattern-optimized (pattern options)
  "ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æœ€é©åŒ–ã—ã¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«")

;; å¤‰æ•°å: æ˜ç¢ºã§èª¬æ˜çš„
(let ((compiled-dfa (build-dfa-from-nfa nfa))
      (optimization-level (getf options :optimization-level 2)))
  ...)

;; å®šæ•°: *ã§å›²ã‚€
(defparameter *default-optimization-level* 2)
(defconstant +max-dfa-states+ 65536)

;; ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…éƒ¨é–¢æ•°: %ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹
(defun %internal-state-transition (state char)
  ...)
```

### 2. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹é‡è¦–ã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°

```lisp
;; å‹å®£è¨€ã®ç©æ¥µçš„ä½¿ç”¨
(defun fast-character-match (char char-class)
  (declare (optimize (speed 3) (safety 1))
           (type character char)
           (type (simple-bit-vector 256) char-class))
  (= 1 (bit char-class (char-code char))))

;; ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³åŒ–å¯¾è±¡ã®æ˜ç¤º
(declaim (inline simple-operation))
(defun simple-operation (a b)
  (+ a b))

;; ãƒ¡ãƒ¢ãƒªåŠ¹ç‡çš„ãªå®Ÿè£…
(defun process-large-text (text pattern)
  (declare (type simple-string text))
  (let ((results (make-array 100 :adjustable t :fill-pointer 0)))
    ...))
```

### 3. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```lisp
;; æ˜ç¢ºãªã‚¨ãƒ©ãƒ¼å‹ã®å®šç¾©
(define-condition regex-compilation-error (regex-error)
  ((pattern :initarg :pattern :reader error-pattern)
   (phase :initarg :phase :reader error-phase)))

;; é©åˆ‡ãªã‚¨ãƒ©ãƒ¼æƒ…å ±ã®æä¾›
(defun compile-pattern (pattern)
  (handler-case
      (compile-pattern-internal pattern)
    (error (e)
      (error 'regex-compilation-error
             :pattern pattern
             :phase :parsing
             :message (format nil "Failed to compile pattern: ~A" e)))))
```

---

## ãƒ†ã‚¹ãƒˆè¦ä»¶

### 1. Property-Based Testing

```lisp
;; å¿…é ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ãƒ†ã‚¹ãƒˆ
(deftest test-match-idempotency ()
  "ãƒãƒƒãƒãƒ³ã‚°çµæœã®å†ªç­‰æ€§ã‚’ãƒ†ã‚¹ãƒˆ"
  (check-it
    (generator (gen-pattern) (gen-text))
    (lambda (pattern text)
      (let ((result1 (match pattern text))
            (result2 (match pattern text)))
        (equal result1 result2)))))

(deftest test-compilation-correctness ()
  "ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã¿ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å‹•çš„ãƒ‘ã‚¿ãƒ¼ãƒ³ã®çµæœä¸€è‡´æ€§"
  (check-it
    (generator (gen-simple-pattern) (gen-text))
    (lambda (pattern text)
      (let ((dynamic-result (match pattern text))
            (compiled-result (match (compile-pattern pattern) text)))
        (equal dynamic-result compiled-result)))))
```

### 2. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ

```lisp
(deftest test-performance-regression ()
  "æ€§èƒ½ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ã®æ¤œå‡º"
  (let* ((pattern "complex.*pattern.*with.*groups")
         (text (generate-test-text 10000))
         (baseline-time 0.001))  ; 1msåŸºæº–

    (multiple-value-bind (result time)
        (time-execution (lambda () (match pattern text)))
      (is (< time (* baseline-time 1.1)))  ; 10%ä»¥å†…ã®åŠ£åŒ–è¨±å®¹
      (is result))))  ; æ­£ã—ã„çµæœã‚‚ç¢ºèª
```

### 3. å¢ƒç•Œå€¤ãƒ†ã‚¹ãƒˆ

```lisp
(deftest test-edge-cases ()
  "ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã®åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆ"
  (testing "ç©ºæ–‡å­—åˆ—"
    (is (match "" "")))

  (testing "æ¥µç«¯ã«é•·ã„ãƒ‘ã‚¿ãƒ¼ãƒ³"
    (let ((long-pattern (make-string 10000 :initial-element #\a)))
      (is (match long-pattern long-pattern))))

  (testing "Unicodeæ–‡å­—"
    (is (match "[Î±-Ï‰]+" "Î±Î²Î³Î´Îµ")))

  (testing "å†å¸°çš„ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ·±ã„ãƒã‚¹ãƒˆ"
    (let ((deep-nested "((((((test))))))"))
      (is (match balanced-parens deep-nested)))))
```

---

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¦ä»¶

### 1. ã‚³ãƒ¼ãƒ‰å†…ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

```lisp
(defun advanced-pattern-optimizer (pattern options)
  "é«˜åº¦ãªãƒ‘ã‚¿ãƒ¼ãƒ³æœ€é©åŒ–ã‚’å®Ÿè¡Œ

Parameters:
  PATTERN - æœ€é©åŒ–å¯¾è±¡ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ (string or compiled-pattern)
  OPTIONS - æœ€é©åŒ–ã‚ªãƒ—ã‚·ãƒ§ãƒ³ (plist)
    :level (0-3) - æœ€é©åŒ–ãƒ¬ãƒ™ãƒ«
    :target (:speed :space :balance) - æœ€é©åŒ–ç›®æ¨™
    :engine (:auto :nfa :dfa :hybrid) - å¼·åˆ¶ã‚¨ãƒ³ã‚¸ãƒ³é¸æŠ

Returns:
  COMPILED-PATTERN - æœ€é©åŒ–ã•ã‚ŒãŸã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã¿ãƒ‘ã‚¿ãƒ¼ãƒ³

Examples:
  (advanced-pattern-optimizer \"hello.*world\" '(:level 3 :target :speed))

Performance:
  - ãƒ¬ãƒ™ãƒ«3ã§ã®æœ€é©åŒ–ã¯10-100å€ã®é«˜é€ŸåŒ–ã‚’å®Ÿç¾
  - ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã¯é€šå¸¸50-80%å‰Šæ¸›

See Also:
  COMPILE-PATTERN, OPTIMIZE-FOR-SPEED"
  ...)
```

### 2. DiÃ¡taxisæº–æ‹ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

æ–°æ©Ÿèƒ½è¿½åŠ æ™‚ã¯ä»¥ä¸‹ã‚’ã™ã¹ã¦æ›´æ–°ï¼š

- **Tutorial**: æ®µéšçš„å­¦ç¿’ã‚¬ã‚¤ãƒ‰
- **How-to**: å…·ä½“çš„ãªä½¿ç”¨æ–¹æ³•
- **Reference**: APIä»•æ§˜ã¨è©³ç´°
- **Explanation**: è¨­è¨ˆæ€æƒ³ã¨ç†è«–

### 3. ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯çµæœã®æ–‡æ›¸åŒ–

```markdown
## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„çµæœ

### æ”¹å–„å†…å®¹
SIMDå‘½ä»¤ã‚’æ´»ç”¨ã—ãŸæ–‡å­—ã‚¯ãƒ©ã‚¹ãƒãƒƒãƒãƒ³ã‚°æœ€é©åŒ–

### ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ç’°å¢ƒ
- CPU: Intel Core i7-9750H (2.6GHz)
- Memory: 16GB DDR4-2666
- OS: Ubuntu 20.04 LTS
- SBCL: 2.2.9

### çµæœ
| Pattern Type | Before | After | Improvement |
|-------------|--------|-------|-------------|
| [a-z]+      | 1.2ms  | 0.3ms | 4.0x        |
| [0-9]{1,5}  | 0.8ms  | 0.2ms | 4.0x        |
| \\w+        | 1.5ms  | 0.4ms | 3.8x        |

### ç†è«–çš„æ ¹æ‹ 
bit-parallel ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ã‚ˆã‚Šã€8æ–‡å­—ã‚’ä¸¦åˆ—å‡¦ç†...
```

---

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ä»¶

### 1. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŠ£åŒ–ã®é˜²æ­¢

```lisp
;; è‡ªå‹•ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
(defun ensure-no-performance-regression (old-implementation new-implementation)
  "æ€§èƒ½åŠ£åŒ–ãŒãªã„ã“ã¨ã‚’ç¢ºèª"
  (let ((test-cases (generate-performance-test-cases)))
    (loop for (pattern text) in test-cases
          for old-time = (benchmark old-implementation pattern text)
          for new-time = (benchmark new-implementation pattern text)
          do (assert (<= new-time (* old-time 1.05))  ; 5%ä»¥å†…ã®åŠ£åŒ–è¨±å®¹
                     () "Performance regression detected: ~A -> ~A"
                     old-time new-time))))
```

### 2. ãƒ¡ãƒ¢ãƒªåŠ¹ç‡è¦ä»¶

```lisp
;; ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯æ¤œå‡º
(deftest test-memory-efficiency ()
  (gc :full t)
  (let ((initial-memory (get-bytes-consed)))

    ;; å¤§é‡å‡¦ç†å®Ÿè¡Œ
    (loop repeat 10000 do
      (match complex-pattern sample-text))

    (gc :full t)
    (let ((final-memory (get-bytes-consed))
          (acceptable-growth (* 1024 1024)))  ; 1MBè¨±å®¹

      (is (< (- final-memory initial-memory) acceptable-growth)))))
```

### 3. ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£è¦ä»¶

```lisp
;; ä¸¦åˆ—ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ
(deftest test-parallel-scalability ()
  (let ((single-thread-time (benchmark-single-thread))
        (quad-thread-time (benchmark-parallel-threads 4)))

    ;; ç†æƒ³çš„ã«ã¯4å€é«˜é€Ÿã€æœ€ä½ã§ã‚‚2å€ã¯å¿…è¦
    (is (>= (/ single-thread-time quad-thread-time) 2.0))))
```

---

## ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹

### 1. ã‚»ãƒ«ãƒ•ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

**å®Ÿè£…å“è³ª**:
- [ ] ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã«æº–æ‹ 
- [ ] é©åˆ‡ãªå‹å®£è¨€ã¨optimizeå®£è¨€
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å®Ÿè£…
- [ ] ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã®å›é¿

**ãƒ†ã‚¹ãƒˆ**:
- [ ] æ–°æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ 
- [ ] æ—¢å­˜ãƒ†ã‚¹ãƒˆã®é€šéç¢ºèª
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
- [ ] ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã®ã‚«ãƒãƒ¼

**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**:
- [ ] é–¢æ•°ãƒ»ãƒã‚¯ãƒ­ã®docstring
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°
- [ ] è¨­è¨ˆæ±ºå®šã®è¨˜éŒ²
- [ ] ä½¿ç”¨ä¾‹ã®æä¾›

**ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**:
- [ ] ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯çµæœã®æ¸¬å®š
- [ ] æ—¢å­˜æ©Ÿèƒ½ã¸ã®å½±éŸ¿ç¢ºèª
- [ ] ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®æ¸¬å®š
- [ ] ç†è«–çš„æ ¹æ‹ ã®èª¬æ˜

### 2. ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦³ç‚¹

**ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ãŒç¢ºèªã™ã¹ãç‚¹**:

1. **ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è¨­è¨ˆ**
   - ç†è«–çš„æ­£ã—ã•
   - æ™‚é–“ãƒ»ç©ºé–“è¤‡é›‘åº¦
   - ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹å¯¾å¿œ

2. **å®Ÿè£…å“è³ª**
   - Lispã‚‰ã—ã„å®Ÿè£…
   - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
   - ä¿å®ˆæ€§

3. **çµ±åˆæ€§**
   - æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã¨ã®æ•´åˆæ€§
   - APIã®ä¸€è²«æ€§
   - å°†æ¥ã®æ‹¡å¼µæ€§

### 3. ãƒãƒ¼ã‚¸åŸºæº–

**å¿…é ˆæ¡ä»¶**:
- [ ] ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒé€šé
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŠ£åŒ–ãªã—
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°å®Œäº†
- [ ] 2åä»¥ä¸Šã®æ‰¿èª

**ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„ã®å ´åˆ**:
- [ ] 10%ä»¥ä¸Šã®æ”¹å–„ã¾ãŸã¯æ–°æ©Ÿèƒ½
- [ ] ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯çµæœã®æ·»ä»˜
- [ ] ç†è«–çš„æ ¹æ‹ ã®èª¬æ˜

---

## ã¾ã¨ã‚

CL-Regexã¯é«˜å“è³ªã®æ­£è¦è¡¨ç¾ã‚¨ãƒ³ã‚¸ãƒ³ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚ã™ã¹ã¦ã®ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãŒã“ã®ç›®æ¨™ã«å‘ã‹ã£ã¦é«˜ã„å“è³ªåŸºæº–ã‚’æº€ãŸã™ã“ã¨ã‚’æœŸå¾…ã—ã¦ã„ã¾ã™ã€‚

**é‡è¦ãªåŸå‰‡**:
1. **æ€§èƒ½æœ€å„ªå…ˆ**: ã™ã¹ã¦ã®å¤‰æ›´ã§æ€§èƒ½ã¸ã®å½±éŸ¿ã‚’è€ƒæ…®
2. **ç†è«–çš„æ ¹æ‹ **: å®Ÿè£…ã«ã¯å¿…ãšç†è«–çš„èƒŒæ™¯ã‚’æŒã¤
3. **åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆ**: Property-Based Testingã«ã‚ˆã‚‹å“è³ªä¿è¨¼
4. **æ˜ç¢ºãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: DiÃ¡taxisãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã«ã‚ˆã‚‹ä½“ç³»çš„èª¬æ˜

è³ªå•ã‚„ææ¡ˆãŒã‚ã‚Œã°ã€Issueã‚„ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã§ãŠæ°—è»½ã«ãŠå£°ãŒã‘ãã ã•ã„ã€‚é«˜å“è³ªã®ã‚¨ãƒ³ã‚¸ãƒ³ã‚’ä¸€ç·’ã«ä½œã‚Šä¸Šã’ã¾ã—ã‚‡ã†ï¼